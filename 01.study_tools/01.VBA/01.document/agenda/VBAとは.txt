概要
 Excel VBA は Excel を自動化するためのプログラミング言語

メリット
 何百行・何千行に対して何らかの処理をする場合がありますが、Excel VBA を使えば一発で処理できる


必要となる知識
 基本的な Excel の使い方
 
環境
 ?

用語
 ワークブック:Excel のファイル 1 つ 1 つ
 ワークシート:ファイル上の各シート
 セル：一つ一つのマス
 オブジェクト：ワークブック、ワークシート、セルの 1 つ 1 つ
 プロパティ：オブジェクトの属性、
 メソッド：オブジェクトに対する処理


開発環境
 Visual Basic Editor
起動方法
 Excel のメニューから「ツール」「マクロ」「Visual Basic Editor」の順にクリック
 プロジェクトが見られるウィンドウが起動。
0:23
ここでは、今扱おうとしているオブジェクトの一覧が表示されています。
メニューの「表示」「ツールバー」「標準」をクリックしてツールバーも表示しておくと、いろいろなショートカットが出てくるので、これも表示させておいてください。
1:10
プログラムを書いていくには、プロジェクトから「挿入」で「標準モジュール」を選んでいきます。
標準モジュールを選ぶと、プログラムを書くウィンドウが現れます。
1:38


「hello world」メッセージを表示
「Sub プロシージャ名()」
最後に「End Sub」で終わるの

中身はに「MsgBox("hello world")」を記述。

ツールバーのプレイボタンを押して実行
hello world と表示されていることを確認。
実際の文は改行で区切っていくことになります。

記述の注意
 「;」不要
 メッセージが長くなって途中で改行をはさみたい場合は、「 _」（スペース、アンダーバー）とすると、「 _」の前後を一行として認識してくれる
1:41
コメントを書きたい場合は「'[b]コメント」とすると、それ以降がコメントになる

ロシージャは複数書くことができて、増やすと自動的に横線を入れてくれます。
。
2:12
HelloWorld2 を実行すると、この hello world 2 が実行されます。



■セルの値の変更方法

ワークシートの Sheet1 の A1 セルの Value プロパティを何らかの値に変えていきます。

ワークシートの指定方法は、「Worksheets("Sheet1")」とします。
0:36
その中のセルを指定する場合は、続けて「.Range」とすれば OK です。
0:43
Range を使った場合は、「.Range("A1")」のような表現ができます
0:48
Value プロパティを指定するには「.Value」とつければ OK です。
0:51
値を代入するには「="hello"」とします。
0:56
「"」で文字列を囲って与えてあげれば、このように A1 セルに hello が反映されているのが分かるかと思います。
1:03
なお、「今アクティブになっているワークシート」という意味だったら、個々の部分は省略できるので「Range("A2").Value = "hello2"」としても同じように動くはずです。
1:18
A2 なので hello の下に表示されるはずです。
1:23
Range を使った場合は「Range("A2")」 という書き方
1:31
1,2,3で表示したい場合、
Cells を使えば OK です。
1:34
「Cells(3,1).Value = "hello3"」とすると、hello2 の下に hello3 が出てくるはずです。
1:50
相対指定
「Cells(3,1).Offset」でいくつ動くか見てみましょう。
2:06
A3 セルから 1 つ下（行方向 1 、列方向 0 ）に動きたいので、「Cells(3,1).Offset(1,0).Value = "hello4"」と書けば OK です。
2:16

2:22
このように、セルを指定して、そのセルの Value プロパティにアクセスして何らかの値を入れる、というのが基本的な方法になります。
2:32



■複数のセルの指定
Range(A5:C7) 例

A1 から B3 までの値を変えたい場合、どのように書いていくか見ていきたいと思います。
0:23
同じように Range を書いていきますが、今度は左上（ A1 ）と右下（ B3 ）を「,」で区切って指定してあげれば OK です。
0:31
「Range("A1","B3").Value = "hello"」とすると、A1 から B3 のセルに hello が表示されたのが分かるかと思います。
0:44
なお、これをもう少し短く書く方法があって、例えば A5 から C7 までを選択する場合は「Range("A5:C7").Value = "hello2"」と指定します。
0:57
選択範囲を「:」で区切ると、「Range("A1","B3").Value = "hello"」と同じ意味になるので、それも覚えておくといいでしょう。
1:06
A5 から C7 のセルに hello2 が表示されたのが分かるかと思います。
1:09
さらに、A5 から C7 の範囲だけではなくて、行全体・列全体を指定したい場合があります。
1:15
そうした場合にどう書くのか見ていきましょう。
1:20
例えば、4 行目だけに何かを入れたい場合には「Range("4:4")」とすれば OK なので、これも覚えておくといいでしょう。
1:28
「Range("4:4").Value = "row 4"」としましょう。
1:33
実行すると、4 行目に row 4 が入っているのが分かるかと思います。
1:38
C 列だけという場合には「Range("C:C").Value = "Column C"」としましょう。
1:52
時間がかかりましたが、C列に「Colum C」が書かれているのが分かるかと思います。
1:58
このように、複数のセルを指定する場合には、いろいろな指定方法があるので覚えておくといいでしょう。
2:04
なお、「Cells.clear」とすれば全て消せるので、これも合わせて覚えておきましょう。
2:11
全部消すのに時間がかかりますが、このように全部クリアされているのが分かるかと思います。
2:21
このような操作にも慣れておくようにしてください。



